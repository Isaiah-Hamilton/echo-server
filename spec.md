# Echo Server Spec

This is an overview spec document which details the endpoint and what they expect to receive and in turn what responses you can expect.

## Responses
These are the default responses and are only different if otherwise specified.

### Successful Response
```
{
    "status": "OK"
}
```

### Unsuccessful Response
```
{
    "status": "FAILED",
    "reasons" [
        { "field": "type", "description": "" }
    ]
}
```

## Requests

### Health
```
GET <ECHO_SERVER_URL>/health
```

#### Example Response
```
OK, echo-server v0.1.0
```

### Register Client

```
POST <ECHO_SERVER_URL>/register
{
    "client_id": <CLIENT_ID>,
    "type": <TYPE>,
    "token": <DEVICE_TOKEN>
}
```

- `CLIENT_ID`: The Client's ID from the Relay pairing.
- `TYPE`: The push service to use e.g. APNS, FCM. This will be validated against the supported types on the Echo Server's side.
- `DEVICE_TOKEN`: The device's token for the push service e.g. FCM, APNS.

## Unregister Client

```
POST <ECHO_SERVER_URL>/unregister
{
    "client_id": <CLIENT_ID>
}
```

- `CLIENT_ID`: The Client's ID from the Relay pairing.

## Webhook Endpoint

> **Note**
> This will have E2E encryption in the future but for now is designed without encryption.

```
POST <ECHO_SERVER_URL>/push
{
    "id": "0000-0000-0000-0000"
    "client_id": <CLIENT_ID>,
    "payload": {
        "message": "You have a signing request."
    }
}
```

- `id`: This is generated by the Relay to prevent duplicate notifications
- `client_id`: This is used to map to the device token
- `payload`: A JSON object that holds the relevant payload data. **NOTE:** This will become a string that is encrypted by the dApp and not decrypted until received by the client